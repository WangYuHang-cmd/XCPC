#  回文自动机 PAM

**回文串和border：**对于回文串S，回文前缀等价于border

- 节点最多N个，每个节点代表了一种回文串.用$S(u)$表示节点u代表的回文串$len[u]=|S(u)|$,表示回文串的长度。
- $v=trans(u,ch)$表示在u节点代表的回文串两边都加上ch字符，即$chS(v)ch$,$len[v]=len[u]+2$
- 每个节点都有失配边，$fail[u]=v$表示u节点的失配边指向了v节点，S(v)是S(u)的最大Border,即最长回文后缀

匹配过程:

考虑新加入p字符，不断沿着fail指针走，知道下一个节点满足$s_p=s_{p-len-1}$

然后求出新建节点的fail指针

