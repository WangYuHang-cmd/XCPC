## 树上莫队

![image-20220119223327548](C:\Users\Henry\AppData\Roaming\Typora\typora-user-images\image-20220119223327548.png)

树上莫队的经典套路：

- 对于值域较大的进行离散化
- 在求解欧拉序的同时处理出每个点在序列中第一次出现和最后一次出现的位置
- `bfs`预处理出`lca`所需数组并在读入询问的时候根据lca判断询问在序列中的起始点
- 对询问排序后进行莫队，每次正常莫队区间完需要判断是否应该加入最近公共祖先